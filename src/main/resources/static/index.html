<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>华为云PaaS学堂</title>
<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery-form.js"></script>
<script type="text/javascript" src="js/jquery-session.js"></script>
<script type="text/javascript">
    var t = new Date();
    var year = t.getFullYear();
    var month = add_zero(t.getMonth() + 1);
    var day = add_zero(t.getDate());
    var hour = add_zero(t.getHours());
    var minute = add_zero(t.getMinutes());
    var second = add_zero(t.getSeconds());
    
    var date = year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second;
    
    function add_zero(temp){
    	if(temp<10){return "0"+temp;}
    	else return temp;
    }
    var classId;
    function getClassId(){
	    url = "hwtraining-teacher-service/hwtraining/v1/currentclassid";
	    $.ajax({
			type : "GET",
			url : url,
			dataType : "json",
			cache : false,
			async : false,
			data : {},
			success : function(data) {
				classId = data;
			},
			error : function(data) {
				alert("Error!!!");
			}
		});
    }
	function selectOpt() {
		classId = $("#classId").find("option:selected").val();
		var menu = $.session.get("menu");
		if(menu=="notice"){notice();}
		if(menu=="task"){taskShow();}
		if(menu=="student"){studentShow(0,0);}	
		if(menu=="score"){scoreShow();}
		if(menu=="forum"){forumShow(0,0);}
		if(menu=="survey"){surveyShow();}
	}
	function taskShow() {
		$.session.set("menu", "task");
		var classIds = $("#classId").find("option:selected").val();
		isLogin();
		$("#survey").fadeOut(10);
		var url = "hwtraining-teacher-service/hwtraining/v1/tasks";
		$
				.ajax({
					type : "GET",
					url : url,
					dataType : "json",
					cache : false,
					async : false,
					data : {
						classId : classIds
					},
					success : function(data) {
						var s = '<table  class="tablelist" ><tr><th width="50px;">班次</th><th width="60px;">状态</th><th width="100px;">截止时间</th><th width="50px;">责任人</th><th width="80px;">角色</th><th width="150px;">任务</th><th width="560px;">任务详情</th><th width="150px;">备注</th></tr>';
						var jsonReturn = eval(data);
						for (var i = 0; i < jsonReturn.length; i++) {
							s += '<tr id="'+i+'"><td >' + jsonReturn[i].classId
									+ '</td><td><input type="button" value="'
									+ jsonReturn[i].status
									+ '" onclick="changeStatus(' + i
									+ ')"/></td><td>' + jsonReturn[i].deadline
									+ '</td><td><input class="taskInput" type="text" value="' + jsonReturn[i].handPeople
									+ '"/></td><td>' + jsonReturn[i].role
									+ '</td><td>' + jsonReturn[i].task
									+ '</td><td title="'+ jsonReturn[i].detail +'">' + jsonReturn[i].detail
									+ '</td><td><textarea rows="6" cols="20"  title="'+ jsonReturn[i].comment +'">'
									+ jsonReturn[i].comment
									+ '</textarea></td></tr>';
						}
						s += '</table><input type="hidden" id="taskslist" value="'+jsonReturn.length+'">'
						$('#dv').html(s);
						$("#control").fadeOut(100);
						$("#forum").fadeOut(100);
					},
					error : function(XMLHttpRequest) {
						commonaction(XMLHttpRequest);
					}
				});
		var taskslist = $("#taskslist").val();
		for (var j = 0; j < taskslist; j++) {
			var btn = $("#" + j + " td:nth-child input[type='button'] ").val();
			if (btn == "1") {
				$("#" + j + " td:nth-child input[type='button'] ").val("已完成");
				$("#" + j + " td:nth-child input[type='button'] ").attr("disabled", "disabled");
				$("#" + j + " td:nth-child input[type='text'] ").attr("disabled", "disabled");
				$("#" + j + " td:nth-child textarea").attr("disabled",
						"disabled");
			} else {
				$("#" + j + " td:nth-child input[type='button'] ").val("未完成");
			}
		}
	}
	function changeStatus(id) {
		classId = $('#' + id + ' td:nth-child(1)').text();
		task = $('#' + id + ' td:nth-child(6)').text();
		handPeople = $('#' + id + ' td:nth-child input[type="text"]').val();
		if(handPeople==""||typeof(handPeople)=="undefined"){
			$("#" + id + " td:nth-child input[type='text'] ").attr("style", "background:#FF6161;");
			$("#" + id + " td:nth-child input[type='text'] ").focus();
			return;
		}
		comment = $('#' + id + ' td:nth-child(8) textarea').val();
		url2 = "hwtraining-teacher-service/hwtraining/v1/tasks";
		$.ajax({
			type : "PUT",
			url : url2,
			dataType : "json",
			cache : false,
			async : false,
			data : {
				classId : classId,
				task : task,
				handPeople : handPeople,
				comment : comment
			},
			success : function(data) {
				taskShow();
			},
			error : function(data) {
				alert("Error!!!");
			}
		});
	}
	$(document).ready(function() {
		getClassId();
		$("#classId").val(classId);
		var divs = document.getElementsByName("aaa");
		var len = divs.length;
		for(var i=0;i<len;i++){
			divs[i].onclick = function(){
				for(var j=0;j<len;j++){
					divs[j].style = "";
				}
				this.style= "background-position:left -56px;";
			};
		}
		var divsb = document.getElementsByName("bbb");
		var lenb = divsb.length;
		for(var i=0;i<lenb;i++){
			divsb[i].onclick = function(){
				for(var j=0;j<lenb;j++){
					divsb[j].style = "";
				}
				this.style= "background-position:left -56px;";
			};
		}
		$.session.set("curStu", 1);
		$.session.set("curForum", 1);
		if(isLogin()){
			$("#option").fadeIn(100);
		}
		notice();
		$("#clickAdd").click(function() {
			var classIds = $("#classId").find("option:selected").val();
			getClassId();
			if(classIds!=classId){
				alert("请切换到正确的班次："+classId+"！！！");
				return;
			}
			$("#tipAdd").fadeIn(200);
		});
		$("#clickDelete").click(function() {
			$("#tipDelete").fadeIn(200);
		});
		$(".tiptop a").click(function() {
			$(".tip").fadeOut(200);
			$(".tipDelete").fadeOut(200);
		});
		$("#sureAdd").click(function() {
			$("#tipAdd").fadeOut(100);
			var companyName = $("#companyName").val();
			var name = $("#name").val();
			var title = $("#title").val();
			var phoneNumber = $("#phoneNumber").val();
			var email = $("#email").val();
			var hwcloudId = $("#hwcloudId").val();
			var comment = $("#comment").val();
			$.ajax({
				type : "POST",
				url : "hwtraining-teacher-service/hwtraining/v1/student",
				contentType : "application/json",
				dataType : "json",
				cache : false,
				async : false,
				data : JSON.stringify({
					"classId" : classId,
					"companyName" : companyName,
					"name" : name,
					"title" : title,
					"phoneNumber" : phoneNumber,
					"email" : email,
					"hwcloudId" : hwcloudId,
					"comment" : comment
				}),
				success : function(data) {
					if (data == true) {
						studentShow(0,0);
					} else {
						alert("false!!!");
						return;
					}
				},
				error : function(data) {
					alert("Error!!!");
				}

			});
		});
		$("#sureDelete").click(function() {
			$("#tipDelete").fadeOut(100);
			obj = document.getElementsByName("student");
			check_val = [];
			for (k in obj) {
				if (obj[k].checked)
					check_val.push(obj[k].value);
			}
			url2 = "hwtraining-teacher-service/hwtraining/v1/student";
			for (k in check_val) {
				n = check_val[k];
				classId = $('#' + n + ' td:nth-child(2)').text();
				name = $('#' + n + ' td:nth-child(4)').text();
				phoneNumber = $('#' + n + ' td:nth-child(6)').text();
				$.ajax({
					type : "DELETE",
					url : url2,
					dataType : "json",
					cache : false,
					async : false,
					data : {
						classId : classId,
						name : name,
						phoneNumber : phoneNumber
					},
					success : function(data) {
						if((parseInt(k)+1)==check_val.length){
							studentShow(0,0);
						}
					},
					error : function(data) {
						alert("Error!!!");
						return;
					}
				});
			}
		});
		$(".cancel").click(function() {
			$(".tip").fadeOut(100);
			$(".tipDelete").fadeOut(100);
		});
	});

	function notice() {
		$.session.set("menu", "notice");
		var s = '<p><b><red>华为PaaS高级培训第五期2018年3月中旬开班，现在启动报名，报名请联系各个合作伙伴对应华为接口人。</red></b></p>';
		$('#dv').html(s);
		$("#control").fadeOut(10);
		$("#forum").fadeOut(10);
		$("#survey").fadeOut(10);
	}
	function studentShow(current,cal) {
		var num1;
		var num2;
		var classIds = $("#classId").find("option:selected").val();
		//console.log("curStu类型：",typeof(current),"cal类型：",typeof(cal));
		$.session.set("menu", "student");
		isLogin();
		$("#control").fadeOut(10);
		$("#survey").fadeOut(10);
		url = "hwtraining-teacher-service/hwtraining/v1/students";
		$
				.ajax({
					type : "GET",
					url : url,
					contentType : "application/json",
					dataType : "json",
					cache : false,
					async : false,
					data : {
						classId : classIds
					},
					success : function(data) {
						var s = '<table  class="tablelist" ><tr><th><input type="checkbox"></th><th>班次</th><th>公司</th><th>姓名</th><th>岗位</th><th>手机号</th><th>邮箱</th><th>公有云账户</th><th>备注</th></tr>';
						var jsonReturn = eval(data);
						var totalNum = jsonReturn.length;
						var currentNum = parseInt($.session.get("curStu"));
						var totalPage = Math.ceil(totalNum/10);
						if(cal != 0){
							currentNum+=cal;
							if(currentNum==0){
								currentNum = 1;
							}
						}
						if(current != 0){
							currentNum = current;
						}
						if(cal==0 && current==0){
							currentNum = 1;
						}
						if(totalNum == 0){
							totalPage =1;
						}
						$.session.set("curStu", currentNum);
						num1 = (currentNum-1) * 10;
						num2 = currentNum * 10;
						for (var i = 0; i < jsonReturn.length; i++) {
							if(i>=num1 && i<num2){
								s += '<tr id="'+i+'"><td><input name="student" type="checkbox" value="'+i+'"/><td >'
										+ jsonReturn[i].classId
										+ '</td><td>'
										+ jsonReturn[i].companyName
										+ '</td><td>'
										+ jsonReturn[i].name
										+ '</td><td>'
										+ jsonReturn[i].title
										+ '</td><td>'
										+ jsonReturn[i].phoneNumber
										+ '</td><td>'
										+ jsonReturn[i].email
										+ '</td><td>'
										+ jsonReturn[i].hwcloudId
										+ '</td><td><textarea disabled="disabled" rows="3" cols="20">'
										+ jsonReturn[i].comment
										+ '</textarea></td></tr>';
							}
						}
						s += '</table><input type="hidden" id="taskslist" value="'+jsonReturn.length+'"><br/>';
						s += '<a onclick="studentShow(1,0);">首页</a><a onclick="studentShow(0,-1);">上一页</a><a onclick="studentShow(0,1);">下一页</a><a onclick="studentShow('+totalPage+',0);">尾页</a> 总条数：'+totalNum;
						$('#dv').html(s);
						$("#control").fadeIn(100);
						$("#forum").fadeOut(100);
					},
					error : function(XMLHttpRequest) {
						commonaction(XMLHttpRequest);
					}
				});
	}
	function scoreShow() {
		$.session.set("menu", "score");
		var classIds = $("#classId").find("option:selected").val();
		url = "hwtraining-teacher-service/hwtraining/v1/studentscore";
		cid = classIds;
		$
				.ajax({
					type : "GET",
					url : url,
					dataType : "json",
					cache : false,
					sync : false,
					data : {
						classId : cid
					},
					success : function(data) {
						var s = '<table  class="tablelist" ><tr><th>班次</th><th>姓名</th><th>遗留应用</th><th>中间件</th><th>容器</th><th>微服务</th><th>航空订票</th><th>车联网</th><th>银行理财</th><th>EI视觉</th><th>签到</th><th>总分</th></tr>';
						var jsonReturn = eval(data);
						for (var i = 0; i < jsonReturn.length; i++) {
							total = parseInt(jsonReturn[i].subject1)
									+ parseInt(jsonReturn[i].subject2)
									+ parseInt(jsonReturn[i].subject3)
									+ parseInt(jsonReturn[i].subject4)
									+ parseInt(jsonReturn[i].subject5)
									+ parseInt(jsonReturn[i].subject6)
									+ parseInt(jsonReturn[i].subject7)
									+ parseInt(jsonReturn[i].subject8)
									+ parseInt(jsonReturn[i].subject9);
							var color = "background-color:#65E9B7";
							if (total < 100) {
								color = "background-color:#FFB6C1";
							} else {
								color = "background-color:#65E9B7";
							}
							if (isLogin()) {
								s += '<tr><td >'
										+ jsonReturn[i].classId
										+ '</td><td>'
										+ jsonReturn[i].name
										+ '</td><td  ondblclick="changeScoreStatus(this)" ><input  type="text" class="score" value="'
										+ jsonReturn[i].subject1
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject2
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject3
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject4
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject5
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject6
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject7
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject8
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td ondblclick="changeScoreStatus(this)"><input type="text" class="score" value="'
										+ jsonReturn[i].subject9
										+ '"  onblur="modifyScore(this)" onkeydown="if(event.keyCode==13) {modifyScore(this)}" disabled="" /></td><td> <input type="text" class="score" style="'+color+'" disabled="disabled" value="'+total+'"/></td></tr>';

							} else {

								s += '<tr><td >'
										+ jsonReturn[i].classId
										+ '</td><td>'
										+ jsonReturn[i].name
										+ '</td><td ><input  type="text" class="score" value="'		
							+ jsonReturn[i].subject1		
							+ '"   disabled="" /></td><td><input type="text" class="score" value="'		
							+ jsonReturn[i].subject2		
							+ '"   disabled="" /></td><td><input type="text" class="score" value="'		
							+ jsonReturn[i].subject3		
							+ '"   disabled="" /></td><td><input type="text" class="score" value="'		
							+ jsonReturn[i].subject4		
							+ '"  disabled="" /></td><td ><input type="text" class="score" value="'		
							+ jsonReturn[i].subject5		
							+ '"  disabled="" /></td><td ><input type="text" class="score" value="'		
							+ jsonReturn[i].subject6		
							+ '"   disabled="" /></td><td><input type="text" class="score" value="'		
							+ jsonReturn[i].subject7		
							+ '"  disabled="" /></td><td ><input type="text" class="score" value="'		
							+ jsonReturn[i].subject8		
							+ '"   disabled="" /></td><td><input type="text" class="score" value="'		
							+ jsonReturn[i].subject9		
							+ '"  disabled="" /></td><td> <input type="text" class="score" style="'+color+'" disabled="disabled" value="'+total+'"/></td></tr>';

							}
						}
						s += '</table><input type="hidden" id="taskslist" value="'+jsonReturn.length+'">'

						$('#dv').html(s);
						$("#control").fadeOut(100);
						$("#forum").fadeOut(100);
						$("#survey").fadeOut(100);
					},
					error : function(data) {
						alert("Error!!!");
					}
				});
	}
	function numberPattern(score){
		var pattern = /^[1-9][0-9]?$/;
		if(pattern.test(score)){
			return true;
		}else{
			return false;
		}
	    console.log(pattern.test(score));
	}
	function modifyScore(id) {
		var tr = $(id).parent().parent().children();
		classId = $(tr[0]).text();
		name = $(tr[1]).text();
		subject1 = $(tr[2]).children("input").attr('value');
		subject2 = $(tr[3]).children("input").attr('value');
		subject3 = $(tr[4]).children("input").attr('value');
		subject4 = $(tr[5]).children("input").attr('value');
		subject5 = $(tr[6]).children("input").attr('value');
		subject6 = $(tr[7]).children("input").attr('value');
		subject7 = $(tr[8]).children("input").attr('value');
		subject8 = $(tr[9]).children("input").attr('value');
		subject9 = $(tr[10]).children("input").attr('value');
		total = parseInt(subject1) + parseInt(subject2) + parseInt(subject3)
				+ parseInt(subject4) + parseInt(subject5) + parseInt(subject6)
				+ parseInt(subject7) + parseInt(subject8) + parseInt(subject9);
		if (total < 100) {
			$(tr[11]).children("input").attr('style', "background-color:#FFB6C1");
		} else {
			$(tr[11]).children("input").attr('style', "background-color:#65E9B7");

		}
		$(tr[11]).children("input").attr('value', total);
		console.log('subject===>', subject1, subject2, subject3, subject4,
				subject5, subject6, subject7, subject8, subject9)
		$.ajax({
			type : "PUT",
			url : url,
			contentType : "application/json",
			dataType : "json",
			cache : false,
			async : false,
			data : JSON.stringify({
				classId : classId,
				name : name,
				subject1 : subject1,
				subject2 : subject2,
				subject3 : subject3,
				subject4 : subject4,
				subject5 : subject5,
				subject6 : subject6,
				subject7 : subject7,
				subject8 : subject8,
				subject9 : subject9
			}),
			success : function(data) {
				if (data == true) {
					$(id).attr('disabled', 'disabled');
				}

			},
			error : function(data) {
				alert("Error!!!");
			}
		});
	}
	function changeScoreStatus(id) {
		console.log($(id).children("input").text());
		$(id).children("input").attr("disabled", false);
		$(id).children("input").focus();
	}
	function forumShow(current,cal) {
		var num1;
		var num2;
		$.session.set("menu", "forum");
		var classIds = $("#classId").find("option:selected").val();
		isLogin();
		var cid = classIds;
		url = "hwtraining-teacher-service/hwtraining/v1/forumcontent";
		$
				.ajax({
					type : "GET",
					url : url,
					dataType : "json",
					cache : false,
					async : false,
					data : {
						classId : cid
					},
					success : function(data) {
						var s = '<table class="forumTable" >';
						var jsonReturn = eval(data);
						var totalNum = jsonReturn.length;
						var currentNum = parseInt($.session.get("curForum"));
						var totalPage = Math.ceil(totalNum/10);
						if(cal != 0){
							currentNum+=cal;
							if(currentNum==0){
								currentNum = 1;
							}
						}
						if(current != 0){
							currentNum = current;
						}
						if(cal==0 && current==0){
							currentNum = 1;
						}
						if(totalNum == 0){
							totalPage =1;
						}
						$.session.set("curForum", currentNum);
						num1 = (currentNum-1) * 10;
						num2 = currentNum * 10;
						for (var i = 0; i < jsonReturn.length; i++) {
							if(i>=num1 && i<num2){
								s += '<tr id="'+i+'" class="list0"><td>'
										+ '<div class="forumLeft"><span>班次：' + jsonReturn[i].classId + '</span>'
										+ '<span>产品：' + jsonReturn[i].tenant + '</span>'
										+ '<span>姓名：' + jsonReturn[i].forumusername + '</span></div></td>'
										+ '<td><div class="forumMain"><div class="forumFirst"><p class="text">'	+ jsonReturn[i].content	+ '</p></div><div class="forumSecond">';
								if(jsonReturn[i].path !="" ){
									s+= '<a href="'+jsonReturn[i].path+'" target="_blank">点击打开图片</a>';
								}
								s+= '</div><div class="forumThird"><span class="date">' + jsonReturn[i].time + '</span></div></td></tr>';
							}
						}
						s += '</table><input type="hidden" id="taskslist" value="'+jsonReturn.length+'">'
						s += '<a onclick="forumShow(1,0);">首页</a><a onclick="forumShow(0,-1);">上一页</a><a onclick="forumShow(0,1);">下一页</a><a onclick="forumShow('+totalPage+',0);">尾页</a> 总条数：'+totalNum;
						$('#dv').html(s);
						$("#forum").fadeIn(100);
						$("#control").fadeOut(100);
						$("#survey").fadeOut(100);
					},
					error : function(data) {
						alert("查询问题失败！");
					}
				});
	}
	function uploadPic() {
		var options = {
			url : "hwtraining-teacher-service/hwtraining/v1/upload",
			type : "POST",
			dataType : "text",
			success : function(data) {
				console.log(data);
				$("#allUrl").attr("src", data);
			},
			error : function(data) {
				alert("上传图片失败！！！");
				console.log(data);
				return;
			}
		};
		var path = $("#allUrl").attr("src");
		if(path==""){
			return;
		}
		$("#uploadForm").ajaxSubmit(options);
	}
	function upload() {
		cid = classId;
		var name = $("#userId").val();
		var forumusername = $("#forumusername").val();
		var tenant = $("#tenant").find("option:selected").val();
		var content = $("#content").val();
		var path = $("#allUrl").attr("src");
		if(path=="images/sample.jpg"){
			path="";
		}
		$.ajax({
			url : "hwtraining-teacher-service/hwtraining/v1/forumcontent",
			type : "POST",
			contentType : "application/json",
			dataType : "json",
			cache : false,
			async : false,
			data : JSON.stringify({
				classId : cid,
				forumusername : forumusername,
				name : name,
				tenant : tenant,
				time : date,
				content : content,
				path : path
			}),
			success : function(data) {
				console.log(data);
				$("#userId").attr("value","");
				$("#forumusername").attr("value","");
				$("#content").attr("value","");
				$("#allUrl").attr("src","images/sample.jpg");
				alert("提交成功！");
				forumShow(0,0);
			},
			error : function(data) {
				alert("保存失败!!!");
				console.log(data);
			}
		});
	}
	function login() {
		var username = $("#username").val();
		var password = $("#password").val();
		var url = "hwtraining-teacher-service/hwtraining/v1/login"
		$.ajax({
			url : url,
			type : "POST",
			contentType : "application/json",
			dataType : "script",
			cache : false,
			async : false,
			data : JSON.stringify({
				userName : username,
				password : password
			}),
			success : function(data) {
				$.session.set('loggedinuser', username ,true);
				$('#dv').html();
				$("#dialog").fadeOut(100);
				$("#option").fadeIn(100);
				taskShow();
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				console.log(XMLHttpRequest.status);
				console.log(XMLHttpRequest.readyState);
				console.log(textStatus);
			},
		});
	}
	function logout() {
		var url = "hwtraining-teacher-service/hwtraining/v1/logout"
		$.ajax({
			url : url,
			type : "DELETE",
			dataType : "script",
			cache : false,
			async : false,
			data : {},
			success : function(data) {
				window.location.reload();
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
			},
		});
		$.session.set("loggedinuser", "");
	}

	function commonaction(XMLHttpRequest) {
		if (XMLHttpRequest.status == "403") {
			$('#dv').html("");
			$("#forum").fadeOut(100);
			isLogin();
		}
	}

	function isLogin() {
		if ($.session.get("loggedinuser") == ""||typeof($.session.get("loggedinuser")) == "undefined") {
			$("#logout").fadeOut(100);
			$("#dialog").fadeIn(100);
			return false;
		} else {
			$("#logout").fadeIn(100);
			$("#dialog").fadeOut(100);
			return true;
		}
	}
	function surveyShow(){
		$.session.set("menu", "survey");
		$('#dv').html("");
		$("#forum").fadeOut(10);
		$("#control").fadeOut(10);
		$("#survey").fadeIn(100);
		dayShow(1);
	}
	function dayShow(day){
		if(day==1){
		    $("#surveyDay1").fadeIn(10);
		    $("#surveyDay2").fadeOut(10);
		    $("#surveyDay3").fadeOut(10);
		}
		if(day==2){
		    $("#surveyDay2").fadeIn(10);
		    $("#surveyDay1").fadeOut(10);
		    $("#surveyDay3").fadeOut(10);
		}
		if(day==3){
		    $("#surveyDay3").fadeIn(10);
		    $("#surveyDay1").fadeOut(10);
		    $("#surveyDay2").fadeOut(10);
		}
	}
	function review(day){
		getClassId();
		var re=[];
		for(var i=1;i<7;i++){
			var radios = document.getElementsByName("day"+day+"0"+i);
			var len = radios.length;
			for(var j=0;j<len;j++){
				if (radios[j].checked) {  
		            re[i-1]=radios[j].value;
		        }  
			}
		}
		var comment = $("#day"+day+"07").val();
		var re1 = "PaaS整体解决方案满意度1,"+re[0]+",PaaS整体解决方案满意度2,"+re[1]+",云中间件满意度1,"+re[2]+",云中间件满意度2,"+re[3]+",CCE满意度1,"+re[4]+",CCE满意度2,"+re[5]+",建议,"+comment;
		var re2 = "DevOps开发满意度1,"+re[0]+",DevOps开发满意度2,"+re[1]+",DevOps运维满意度1,"+re[2]+",DevOps运维满意度2,"+re[3]+",实战满意度1,"+re[4]+",实战满意度2,"+re[5]+",建议,"+comment;
		var re3 = "EI解决方案满意度1,"+re[0]+",EI解决方案满意度2,"+re[1]+",大数据平台满意度1,"+re[2]+",大数据平台满意度2,"+re[3]+",人工智能满意度1,"+re[4]+",人工智能满意度2,"+re[5]+",建议,"+comment;
		var rev;
		if(day==1){rev = re1;}
		if(day==2){rev = re2;}
		if(day==3){rev = re3;}
		$.ajax({
			url : "hwtraining-teacher-service/hwtraining/v1/survey",
			type : "POST",
			contentType : "application/json",
			dataType : "json",
			cache : false,
			async : false,
			data : JSON.stringify({
				classId : classId,
				day : day,
				comment : rev
			}),
			success : function(data) {
				alert("感谢您的评价！！！");
				/* for(var i=1;i<7;i++){
					var radios = document.getElementsByName("day"+day+"0"+i);
					var len = radios.length;
					for(var j=0;j<len;j++){
				       radios[j].attr("checked",false);
					}
				} */
				$("#day"+day+"07").attr("value","");
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
			},
		});
	}
</script>
</head>
<body>
	<div>
		<img src="images/huaweilogo.jpg" style="margin: 0 auto;" alt="wenqi blog" />
	</div>
	<div class="menu">
		<a name="aaa" href="javascript:notice();">华为云PaaS学堂公告</a>
		<a name="aaa" href="javascript:taskShow();">培训流程管理</a>
		<a name="aaa" href="javascript:studentShow(0,0);">学员报名管理</a>
		<a name="aaa" href="javascript:scoreShow();">学员成绩管理</a>
		<a name="aaa" href="javascript:forumShow(0,0);">产品问题管理</a>
		<a name="aaa" href="javascript:surveyShow();">课程反馈</a>
		<div id="option" class="vocation" style="display: none;">
		         班次：
		    <select id="classId" onchange="selectOpt()">
				<option value="201801">201801</option>
		        <option value="201802">201802</option>
				<option value="201803">201803</option>
				<option value="201804">201804</option>
				<option value="201805">201805</option>
				<option value="201806">201806</option>
				<option value="201807">201807</option>
				<option value="201808">201808</option>
				<option value="201809">201809</option>
				<option value="201810">201810</option>
				<option value="201811">201811</option>
				<option value="201812">201812</option>
	        </select>
		</div>
	    <div id="logout" class="logout">
			<button onclick="logout()">退出</button>
		</div>
		<div id="dialog" class="logout">
		    <input id="username" class="ui-dialog-input" type="text" placeholder="用户名" value="" />
			<input id="password" class="ui-dialog-input" type="password" placeholder="密码" value="" />
		    <button onclick="login()">登录</button>
		</div>
	</div>
	<div id="control" class="tools" style="display: none;">
		<ul class="toolbar">
			<li class="click" id="clickAdd"><span><img
					src="images/t01.png" /></span>添加</li>
			<li class="click" id="clickDelete"><span><img
					src="images/t03.png" /></span>删除</li>
		</ul>
	</div>

	<div class="tip" id="tipAdd">
		<div class="tiptop" style="width: 785px;">
			<span>信息</span><a></a>
		</div>

		<div class="tipinfo">
			<!-- <span><img src="images/ticon.png" /></span> -->
			<div class="tipright">
				<ul class="forminfo">
					<!-- <li><label><b>* 请仔细核对学员信息，确认无误后提交。</b></label></li> -->
					<li>
					    <label>公司名称<b>*</b></label>
					    <input type="text" class="dfinput" style="width: 518px;" id="companyName" />
					</li>
					<li>
					    <label>姓名<b>*</b></label>
					    <input type="text" class="dfinput" style="width: 518px;" id="name" />
					</li>
					<li>
					    <label>岗位<b>*</b></label>
					    <input type="text" class="dfinput" style="width: 518px;" id="title" />
					</li>
					<li>
					    <label>手机号<b>*</b></label>
					    <input type="text" class="dfinput" style="width: 518px;" id="phoneNumber" />
					</li>
					<li>
					    <label>邮箱<b>*</b></label>
					    <input type="text" class="dfinput" style="width: 518px;" id="email" />
					</li>
					<li>
					    <label>华为云账号<b>*</b></label>
					    <input type="text" class="dfinput" style="width: 518px;" id="hwcloudId" />
					</li>
					<li>
					    <label>备注</label>
					    <input type="text" class="dfinput" style="width: 518px;" id="comment" />
					</li>
				</ul>
			</div>
		</div>

		<div class="tipbtn">
			<input name="" type="button" class="sure" id="sureAdd" value="确定" />&nbsp;
			<input name="" type="button" class="cancel" value="取消" />
		</div>

	</div>
	<div class="tipDelete" id="tipDelete">
		<div class="tiptop" style="width: 385px;">
			<span>信息</span><a></a>
		</div>

		<div class="tipinfo">
			<span><img src="images/ticon.png" /></span>
			<div class="tipright">
				<p>是否确认删除所选中学员 ？</p>
				<cite>如果是请点击确定按钮 ，否则请点取消。</cite>
			</div>
		</div>

		<div class="tipbtn">
			<input name="" type="button" class="sure" id="sureDelete" value="确定" />&nbsp;
			<input name="" type="button" class="cancel" value="取消" />
		</div>
	</div>
	<div id="forum" class="basic-grey" style="display: none;">
		<table>
			<tr>
				<td>
	                                           姓 名 :<input id="forumusername" type="text" name="forumusername" placeholder="" />
		                                  租户名:<input id="userId" type="text" name="userId" placeholder="" />
		                                  产 品 :<select id="tenant" name="tenant" placeholder="" >
		            	        <option value="中间件">中间件</option>
		            	        <option value="CCE">CCE</option>
		            	        <option value="CSE">CSE</option>
		            	        <option value="软件开发云">软件开发云</option>
		            	        <option value="DIS">DIS</option>
		            	        <option value="MRS">MRS</option>
		            	        <option value="MLS">MLS</option>
		            	        <option value="其他">其他</option>
		            	    </select>
				</td>
			</tr>
		    <tr>
				<td>
		                        问题描述 :<br/><textarea id="content" name="content" placeholder="Your Message to Us"></textarea><br/>您最多可输入1000字
				</td>
				<td>
					 <form action="" method="post" id="uploadForm" enctype="multipart/form-data">
						 <label for="file">
						     <img width="100" height="100" id="allUrl" src="images/sample.jpg" />
						 </label>
						 <input type="file" id="file" name="file" onchange="uploadPic()" style="display:none;"/>
					 </form>
				</td>
			</tr>
			<tr>
				<td>
				    <input type="button" class="button" onclick="upload()" value="提交" />
				</td>
			</tr>
		</table>
	</div>
	<div id="survey">
	    <div class="menu"> 
		    <a name="bbb" href="javascript:dayShow(1);">Day1</a>
		    <a name="bbb" href="javascript:dayShow(2);">Day2</a>
		    <a name="bbb" href="javascript:dayShow(3);">Day3</a>
	    </div>
		<div id="surveyHead">
			<p>您好，感谢您参加此次培训，为使后续的培训能够更好的满足学院的需求，请您花费1分钟，对培训课程给出您的满意度评价。此次问卷为不记名调查，请您放心填写，我们需要您的真实反馈。</p>
		</div>
		<div id="surveyDay1">
			<p>1、对《深入理解云计算PaaS&华为云PaaS整体解决方案》的满意度<br/>
			非常不满意
			<input type="radio" name="day101" value="1"/>1
			<input type="radio" name="day101" value="2"/>2
			<input type="radio" name="day101" value="3"/>3
			<input type="radio" name="day101" value="4"/>4
			<input type="radio" name="day101" value="5"/>5非常满意</p>
			<p>2、《深入理解云计算PaaS&华为云PaaS整体解决方案》的课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day102" value="1"/>1
			<input type="radio" name="day102" value="2"/>2
			<input type="radio" name="day102" value="3"/>3
			<input type="radio" name="day102" value="4"/>4
			<input type="radio" name="day102" value="5"/>5非常满意</p>
			<p>3、对课程《掌握云中间件服务》的满意度<br/>
			非常不满意
			<input type="radio" name="day103" value="1"/>1
			<input type="radio" name="day103" value="2"/>2
			<input type="radio" name="day103" value="3"/>3
			<input type="radio" name="day103" value="4"/>4
			<input type="radio" name="day103" value="5"/>5非常满意</p>
			<p>4、《掌握云中间件服务》的课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day104" value="1"/>1
			<input type="radio" name="day104" value="2"/>2
			<input type="radio" name="day104" value="3"/>3
			<input type="radio" name="day104" value="4"/>4
			<input type="radio" name="day104" value="5"/>5非常满意</p>
			<p>5、对课程《CCE容器引擎实现应用快速上线》的满意度<br/>
			非常不满意
			<input type="radio" name="day105" value="1"/>1
			<input type="radio" name="day105" value="2"/>2
			<input type="radio" name="day105" value="3"/>3
			<input type="radio" name="day105" value="4"/>4
			<input type="radio" name="day105" value="5"/>5非常满意</p>
			<p>6、《CCE容器引擎实现应用快速上线》的课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day106" value="1"/>1
			<input type="radio" name="day106" value="2"/>2
			<input type="radio" name="day106" value="3"/>3
			<input type="radio" name="day106" value="4"/>4
			<input type="radio" name="day106" value="5"/>5非常满意</p>
			<p>7、写下您的宝贵意见<br/>
			<textarea name="day1" id="day107"></textarea></p>
			<button onclick="review(1)">提交</button>
		</div>
		<div id="surveyDay2">
			<p>1、对课程《企业应用云化Devops（微服务开发、上线、治理）》的满意度<br/>
			非常不满意
			<input type="radio" name="day201" value="1"/>1
			<input type="radio" name="day201" value="2"/>2
			<input type="radio" name="day201" value="3"/>3
			<input type="radio" name="day201" value="4"/>4
			<input type="radio" name="day201" value="5"/>5非常满意</p>
			<p>2、《企业应用云化Devops（微服务开发、上线、治理）》的课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day202" value="1"/>1
			<input type="radio" name="day202" value="2"/>2
			<input type="radio" name="day202" value="3"/>3
			<input type="radio" name="day202" value="4"/>4
			<input type="radio" name="day202" value="5"/>5非常满意</p>
			<p>3、对课程《企业应用云化Devops（微服务运维）》的满意度<br/>
			非常不满意
			<input type="radio" name="day203" value="1"/>1
			<input type="radio" name="day203" value="2"/>2
			<input type="radio" name="day203" value="3"/>3
			<input type="radio" name="day203" value="4"/>4
			<input type="radio" name="day203" value="5"/>5非常满意</p>
			<p>4、《企业应用云化Devops（微服务运维）》课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day204" value="1"/>1
			<input type="radio" name="day204" value="2"/>2
			<input type="radio" name="day204" value="3"/>3
			<input type="radio" name="day204" value="4"/>4
			<input type="radio" name="day204" value="5"/>5非常满意</p>
			<p>5、对课程《实战：基于微服务、容器技术构建航空订票系统》的满意度<br/>
			非常不满意
			<input type="radio" name="day205" value="1"/>1
			<input type="radio" name="day205" value="2"/>2
			<input type="radio" name="day205" value="3"/>3
			<input type="radio" name="day205" value="4"/>4
			<input type="radio" name="day205" value="5"/>5非常满意</p>
			<p>6、《实战：基于微服务、容器技术构建航空订票系统》课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day206" value="1"/>1
			<input type="radio" name="day206" value="2"/>2
			<input type="radio" name="day206" value="3"/>3
			<input type="radio" name="day206" value="4"/>4
			<input type="radio" name="day206" value="5"/>5非常满意</p>
			<p>7、写下您的宝贵意见<br/>
			<textarea name="day2" id="day207"></textarea></p>
			<button onclick="review(2)">提交</button>
		</div>
		<div id="surveyDay3">
			<p>1、对课程《深入理解华为云EI（企业智能）解决方案》的满意度<br/>
			非常不满意
			<input type="radio" name="day301" value="1"/>1
			<input type="radio" name="day301" value="2"/>2
			<input type="radio" name="day301" value="3"/>3
			<input type="radio" name="day301" value="4"/>4
			<input type="radio" name="day301" value="5"/>5非常满意</p>
			<p>2、《深入理解华为云EI（企业智能）解决方案》的课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day302" value="1"/>1
			<input type="radio" name="day302" value="2"/>2
			<input type="radio" name="day302" value="3"/>3
			<input type="radio" name="day302" value="4"/>4
			<input type="radio" name="day302" value="5"/>5非常满意</p>
			<p>3、对课程《掌握华为云EI大数据平台服务（DIS、MRS）》的满意度<br/>
			非常不满意
			<input type="radio" name="day303" value="1"/>1
			<input type="radio" name="day303" value="2"/>2
			<input type="radio" name="day303" value="3"/>3
			<input type="radio" name="day303" value="4"/>4
			<input type="radio" name="day303" value="5"/>5非常满意</p>
			<p>4、《掌握华为云EI大数据平台服务（DIS、MRS）》课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day304" value="1"/>1
			<input type="radio" name="day304" value="2"/>2
			<input type="radio" name="day304" value="3"/>3
			<input type="radio" name="day304" value="4"/>4
			<input type="radio" name="day304" value="5"/>5非常满意</p>
			<p>5、对课程《掌握华为云EI人工智能基础平台服务（MLS）》的满意度<br/>
			非常不满意
			<input type="radio" name="day305" value="1"/>1
			<input type="radio" name="day305" value="2"/>2
			<input type="radio" name="day305" value="3"/>3
			<input type="radio" name="day305" value="4"/>4
			<input type="radio" name="day305" value="5"/>5非常满意</p>
			<p>6、《掌握华为云EI人工智能基础平台服务（MLS）》课程讲师表达清晰，重点突出<br/>
			非常不满意
			<input type="radio" name="day306" value="1"/>1
			<input type="radio" name="day306" value="2"/>2
			<input type="radio" name="day306" value="3"/>3
			<input type="radio" name="day306" value="4"/>4
			<input type="radio" name="day306" value="5"/>5非常满意</p>
			<p>7、写下您的宝贵意见<br/>
			<textarea name="day3" id="day307"></textarea></p>
			<button onclick="review(3)">提交</button>
		</div>
	</div>
	<div id="dv"></div>
</body>

</html>